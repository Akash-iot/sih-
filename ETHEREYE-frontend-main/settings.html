<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETHER-EYE | Advanced Settings</title>
    <script src="js/api-client.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%); 
            color: #fff; min-height: 100vh; display: flex; 
        }
        
        .sidebar { 
            width: 280px; background: rgba(42, 42, 60, 0.95); backdrop-filter: blur(20px);
            padding: 25px; height: 100vh; position: fixed; overflow-y: auto; 
            box-shadow: 2px 0 20px rgba(0,0,0,0.3);
        }
        .sidebar .logo { 
            font-size: 24px; font-weight: bold; color: #6b48ff; margin-bottom: 30px; cursor: pointer; 
        }
        .sidebar .logo::before { content: "‚öôÔ∏è"; margin-right: 12px; }
        
        .sidebar h3 { 
            font-size: 14px; text-transform: uppercase; margin-bottom: 15px; 
            color: #888; font-weight: 600; 
        }
        .sidebar ul { list-style: none; margin-bottom: 30px; }
        .sidebar ul li { margin-bottom: 8px; }
        .sidebar ul li a { 
            display: flex; align-items: center; color: #b0b0c0; text-decoration: none; 
            padding: 12px 15px; border-radius: 8px; transition: all 0.3s ease; 
        }
        .sidebar ul li a:hover, .sidebar ul li a.active { 
            background: rgba(107, 72, 255, 0.2); color: #fff; transform: translateX(5px); 
        }
        .sidebar ul li a::before { margin-right: 12px; font-size: 16px; }
        .sidebar ul li a.dashboard::before { content: "üìä"; }
        .sidebar ul li a.wallets::before { content: "üëõ"; }
        .sidebar ul li a.traces::before { content: "üîç"; }
        .sidebar ul li a.analytics::before { content: "üìà"; }
        .sidebar ul li a.explorer::before { content: "üåê"; }
        .sidebar ul li a.spider-map::before { content: "üï∏Ô∏è"; }
        .sidebar ul li a.settings::before { content: "‚öôÔ∏è"; }
        
        .content { margin-left: 280px; flex: 1; padding: 25px; }
        
        .header { 
            background: rgba(42, 42, 60, 0.95); backdrop-filter: blur(20px); 
            padding: 25px; border-radius: 15px; margin-bottom: 25px; 
            display: flex; justify-content: space-between; align-items: center; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.3); 
        }
        .header h1 { font-size: 28px; font-weight: 700; color: #6b48ff; }
        .header-actions { display: flex; gap: 15px; }
        .btn { 
            padding: 12px 24px; border: none; border-radius: 8px; cursor: pointer; 
            font-size: 14px; font-weight: 600; transition: all 0.3s ease; 
        }
        .btn-primary { 
            background: linear-gradient(135deg, #6b48ff 0%, #5a3de6 100%); color: white; 
        }
        .btn-secondary { 
            background: rgba(255, 255, 255, 0.1); color: white; 
            border: 1px solid rgba(255, 255, 255, 0.3); 
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        
        .settings-grid { 
            display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); 
            gap: 25px; margin-bottom: 25px; 
        }
        .settings-card { 
            background: rgba(42, 42, 60, 0.95); border-radius: 15px; padding: 25px; 
            border: 1px solid rgba(107, 72, 255, 0.3); position: relative; overflow: hidden; 
        }
        .settings-card::before { 
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; 
            background: linear-gradient(90deg, #6b48ff, #ff6b48); 
        }
        .settings-card h3 { 
            font-size: 20px; font-weight: 600; color: #6b48ff; margin-bottom: 20px; 
            display: flex; align-items: center; 
        }
        .settings-card h3::before { font-size: 24px; margin-right: 12px; }
        .settings-card.profile h3::before { content: "üë§"; }
        .settings-card.general h3::before { content: "‚öôÔ∏è"; }
        .settings-card.notifications h3::before { content: "üîî"; }
        .settings-card.api h3::before { content: "üîå"; }
        .settings-card.privacy h3::before { content: "üõ°Ô∏è"; }
        .settings-card.appearance h3::before { content: "üé®"; }
        
        .setting-item { 
            display: flex; justify-content: space-between; align-items: center; 
            padding: 15px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); 
        }
        .setting-item:last-child { border-bottom: none; }
        .setting-info { flex: 1; }
        .setting-title { font-size: 16px; font-weight: 600; color: #fff; margin-bottom: 5px; }
        .setting-desc { font-size: 14px; color: rgba(255, 255, 255, 0.7); }
        
        .toggle-switch { 
            width: 50px; height: 26px; background: rgba(255, 255, 255, 0.2); 
            border-radius: 26px; position: relative; cursor: pointer; 
            transition: all 0.3s ease; 
        }
        .toggle-switch::after { 
            content: ''; position: absolute; width: 22px; height: 22px; 
            background: white; border-radius: 50%; top: 2px; left: 2px; 
            transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.2); 
        }
        .toggle-switch.active { background: linear-gradient(135deg, #6b48ff 0%, #5a3de6 100%); }
        .toggle-switch.active::after { left: 26px; }
        
        .input-field { 
            width: 100%; padding: 12px 16px; border: 2px solid rgba(107, 72, 255, 0.3); 
            border-radius: 8px; background: rgba(255, 255, 255, 0.1); color: #fff; 
            font-size: 14px; outline: none; transition: all 0.3s ease; 
        }
        .input-field:focus { border-color: #6b48ff; box-shadow: 0 0 0 3px rgba(107, 72, 255, 0.2); }
        .input-field::placeholder { color: rgba(255, 255, 255, 0.6); }
        
        .select-field { 
            width: 100%; padding: 12px 16px; border: 2px solid rgba(107, 72, 255, 0.3); 
            border-radius: 8px; background: rgba(42, 42, 60, 0.9); color: #fff; 
            font-size: 14px; outline: none; cursor: pointer; 
        }
        .select-field option { background: rgba(42, 42, 60, 0.95); color: #fff; }
        
        .user-profile { 
            display: flex; align-items: center; gap: 20px; margin-bottom: 25px; 
        }
        .avatar { 
            width: 80px; height: 80px; border-radius: 50%; 
            background: linear-gradient(135deg, #6b48ff 0%, #5a3de6 100%); 
            display: flex; align-items: center; justify-content: center; 
            font-size: 32px; font-weight: bold; color: white; cursor: pointer; 
            transition: all 0.3s ease; 
        }
        .avatar:hover { transform: scale(1.05); }
        .profile-info { flex: 1; }
        .profile-name { font-size: 24px; font-weight: 600; color: #fff; margin-bottom: 5px; }
        .profile-email { font-size: 14px; color: rgba(255, 255, 255, 0.7); }
        .profile-status { 
            display: inline-block; padding: 4px 12px; background: rgba(40, 167, 69, 0.3); 
            color: #28a745; border-radius: 20px; font-size: 12px; font-weight: 600; 
            text-transform: uppercase; margin-top: 10px; 
        }
        
        .api-status { 
            display: flex; align-items: center; gap: 10px; padding: 15px; 
            background: rgba(255, 255, 255, 0.05); border-radius: 10px; margin-bottom: 20px; 
        }
        .status-indicator { 
            width: 12px; height: 12px; border-radius: 50%; 
            background: #28a745; animation: pulse 2s infinite; 
        }
        .status-indicator.offline { background: #dc3545; animation: none; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        
        .stats-row { 
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px; 
        }
        .stat-item { 
            text-align: center; padding: 15px; background: rgba(255, 255, 255, 0.05); 
            border-radius: 10px; 
        }
        .stat-value { font-size: 20px; font-weight: bold; color: #6b48ff; }
        .stat-label { font-size: 12px; color: rgba(255, 255, 255, 0.7); margin-top: 5px; }
        
        .danger-zone { 
            background: rgba(220, 53, 69, 0.1); border: 1px solid rgba(220, 53, 69, 0.3); 
            border-radius: 15px; padding: 25px; margin-top: 25px; 
        }
        .danger-zone h3 { color: #dc3545; margin-bottom: 15px; }
        .danger-zone p { color: rgba(255, 255, 255, 0.8); margin-bottom: 20px; }
        .btn-danger { 
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); 
            color: white; 
        }
        
        .notification { 
            position: fixed; top: 20px; right: 20px; z-index: 10000; 
            padding: 15px 20px; border-radius: 8px; color: white; font-weight: 600; 
            max-width: 350px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); 
            transform: translateX(100%); opacity: 0; transition: all 0.3s ease; 
        }
        .notification.show { transform: translateX(0); opacity: 1; }
        .notification-success { background: linear-gradient(135deg, #28a745, #20c997); }
        .notification-warning { background: linear-gradient(135deg, #ffc107, #fd7e14); }
        .notification-error { background: linear-gradient(135deg, #dc3545, #e83e8c); }
        .notification-info { background: linear-gradient(135deg, #17a2b8, #6610f2); }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar { width: 70px; padding: 15px; }
            .sidebar h3, .sidebar ul li a span { display: none; }
            .sidebar ul li a { justify-content: center; }
            .content { margin-left: 70px; padding: 15px; }
            .header { flex-direction: column; gap: 15px; }
            .header-actions { justify-content: center; width: 100%; }
            .settings-grid { grid-template-columns: 1fr; }
            .user-profile { flex-direction: column; text-align: center; }
            .stats-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo" onclick="window.location.href='index.html'">ETHER-EYE</div>
        <h3>Main Navigation</h3>
        <ul>
            <li><a href="dashboard.html" class="dashboard"><span>Dashboard</span></a></li>
            <li><a href="wallets.html" class="wallets"><span>Wallets</span></a></li>
            <li><a href="traces.html" class="traces"><span>Traces</span></a></li>
            <li><a href="analytics.html" class="analytics"><span>Analytics</span></a></li>
        </ul>
        <h3>Advanced Tools</h3>
        <ul>
            <li><a href="explorer.html" class="explorer"><span>Explorer</span></a></li>
            <li><a href="spider-map.html" class="spider-map"><span>Spider Map</span></a></li>
            <li><a href="settings.html" class="settings active"><span>Settings</span></a></li>
        </ul>
    </div>
    
    <div class="content">
        <div class="header">
            <h1>‚öôÔ∏è Advanced Settings</h1>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="resetSettings()">üîÑ Reset to Defaults</button>
                <button class="btn btn-primary" id="saveBtn" onclick="saveSettings()">üíæ Save Changes</button>
            </div>
        </div>
        
        <div class="settings-grid">
            <div class="settings-card profile">
                <h3>User Profile</h3>
                <div class="user-profile">
                    <div class="avatar" onclick="changeAvatar()">üë§</div>
                    <div class="profile-info">
                        <div class="profile-name" id="profileName">Anonymous User</div>
                        <div class="profile-email" id="profileEmail">user@ethereye.com</div>
                        <div class="profile-status">Active</div>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Display Name</div>
                        <input type="text" class="input-field" id="displayName" placeholder="Enter your display name">
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Email Address</div>
                        <input type="email" class="input-field" id="emailAddress" placeholder="your@email.com">
                    </div>
                </div>
                
                <div class="stats-row">
                    <div class="stat-item">
                        <div class="stat-value" id="walletsCount">0</div>
                        <div class="stat-label">Wallets Tracked</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="searchesCount">0</div>
                        <div class="stat-label">Searches Made</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="daysActive">0</div>
                        <div class="stat-label">Days Active</div>
                    </div>
                </div>
            </div>
            
            <div class="settings-card general">
                <h3>General Settings</h3>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Auto Refresh</div>
                        <div class="setting-desc">Automatically refresh data every 30 seconds</div>
                    </div>
                    <div class="toggle-switch" id="autoRefresh" onclick="toggleSetting('autoRefresh')"></div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Live Updates</div>
                        <div class="setting-desc">Show real-time blockchain activity</div>
                    </div>
                    <div class="toggle-switch active" id="liveUpdates" onclick="toggleSetting('liveUpdates')"></div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Currency</div>
                        <div class="setting-desc">Default currency for price display</div>
                    </div>
                    <select class="select-field" id="currency">
                        <option value="usd">USD ($)</option>
                        <option value="eur">EUR (‚Ç¨)</option>
                        <option value="gbp">GBP (¬£)</option>
                        <option value="btc">BTC (‚Çø)</option>
                    </select>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Language</div>
                        <div class="setting-desc">Interface language</div>
                    </div>
                    <select class="select-field" id="language">
                        <option value="en">English</option>
                        <option value="es">Espa√±ol</option>
                        <option value="fr">Fran√ßais</option>
                        <option value="de">Deutsch</option>
                        <option value="zh">‰∏≠Êñá</option>
                    </select>
                </div>
            </div>
            
            <div class="settings-card appearance">
                <h3>Appearance</h3>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Dark Mode</div>
                        <div class="setting-desc">Use dark theme across the application</div>
                    </div>
                    <div class="toggle-switch active" id="darkMode" onclick="toggleSetting('darkMode')"></div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Compact Mode</div>
                        <div class="setting-desc">Reduce spacing for more content</div>
                    </div>
                    <div class="toggle-switch" id="compactMode" onclick="toggleSetting('compactMode')"></div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Theme Color</div>
                        <div class="setting-desc">Primary accent color</div>
                    </div>
                    <select class="select-field" id="themeColor">
                        <option value="purple">Purple</option>
                        <option value="blue">Blue</option>
                        <option value="green">Green</option>
                        <option value="orange">Orange</option>
                        <option value="red">Red</option>
                    </select>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Font Size</div>
                        <div class="setting-desc">Interface font size</div>
                    </div>
                    <select class="select-field" id="fontSize">
                        <option value="small">Small</option>
                        <option value="medium" selected>Medium</option>
                        <option value="large">Large</option>
                    </select>
                </div>
            </div>
            
            <div class="settings-card notifications">
                <h3>Notifications</h3>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Push Notifications</div>
                        <div class="setting-desc">Receive browser notifications</div>
                    </div>
                    <div class="toggle-switch active" id="pushNotifications" onclick="toggleSetting('pushNotifications')"></div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Transaction Alerts</div>
                        <div class="setting-desc">Alert for large transactions</div>
                    </div>
                    <div class="toggle-switch active" id="transactionAlerts" onclick="toggleSetting('transactionAlerts')"></div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Price Alerts</div>
                        <div class="setting-desc">Notify on significant price changes</div>
                    </div>
                    <div class="toggle-switch" id="priceAlerts" onclick="toggleSetting('priceAlerts')"></div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Alert Threshold</div>
                        <div class="setting-desc">Minimum transaction value for alerts (ETH)</div>
                    </div>
                    <input type="number" class="input-field" id="alertThreshold" placeholder="10" min="0" step="0.1">
                </div>
            </div>
            
            <div class="settings-card api">
                <h3>API Configuration</h3>
                
                <div class="api-status">
                    <div class="status-indicator" id="apiStatus"></div>
                    <div>
                        <strong>API Status:</strong> <span id="apiStatusText">Connected</span><br>
                        <small>Last checked: <span id="lastChecked">Never</span></small>
                    </div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">API Endpoint</div>
                        <div class="setting-desc">Backend API server URL</div>
                    </div>
                    <input type="url" class="input-field" id="apiEndpoint" placeholder="http://localhost:8000">
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Request Timeout</div>
                        <div class="setting-desc">API request timeout in seconds</div>
                    </div>
                    <input type="number" class="input-field" id="requestTimeout" placeholder="30" min="5" max="300">
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Rate Limiting</div>
                        <div class="setting-desc">Enable API rate limiting protection</div>
                    </div>
                    <div class="toggle-switch active" id="rateLimiting" onclick="toggleSetting('rateLimiting')"></div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="testApiConnection()">üîå Test Connection</button>
                </div>
            </div>
            
            <div class="settings-card privacy">
                <h3>Privacy & Security</h3>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Analytics Tracking</div>
                        <div class="setting-desc">Allow anonymous usage analytics</div>
                    </div>
                    <div class="toggle-switch" id="analytics" onclick="toggleSetting('analytics')"></div>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Data Retention</div>
                        <div class="setting-desc">How long to keep search history</div>
                    </div>
                    <select class="select-field" id="dataRetention">
                        <option value="7">7 days</option>
                        <option value="30" selected>30 days</option>
                        <option value="90">90 days</option>
                        <option value="365">1 year</option>
                        <option value="0">Forever</option>
                    </select>
                </div>
                
                <div class="setting-item">
                    <div class="setting-info">
                        <div class="setting-title">Auto-logout</div>
                        <div class="setting-desc">Automatically log out after inactivity</div>
                    </div>
                    <div class="toggle-switch" id="autoLogout" onclick="toggleSetting('autoLogout')"></div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="clearSearchHistory()">üóëÔ∏è Clear Search History</button>
                    <button class="btn btn-secondary" onclick="clearWalletData()" style="margin-left: 10px;">üóëÔ∏è Clear Wallet Data</button>
                </div>
            </div>
        </div>
        
        <div class="danger-zone">
            <h3>‚ö†Ô∏è Danger Zone</h3>
            <p>These actions cannot be undone. Please proceed with caution.</p>
            <button class="btn btn-danger" onclick="resetAllSettings()">üî• Reset All Settings</button>
            <button class="btn btn-danger" onclick="deleteAllData()" style="margin-left: 15px;">üíÄ Delete All Data</button>
        </div>
    </div>
    
    <script>
        let settings = {};
        let apiClient = null;
        
        // Default settings
        const defaultSettings = {
            // Profile
            displayName: 'Anonymous User',
            emailAddress: 'user@ethereye.com',
            
            // General
            autoRefresh: false,
            liveUpdates: true,
            currency: 'usd',
            language: 'en',
            
            // Appearance
            darkMode: true,
            compactMode: false,
            themeColor: 'purple',
            fontSize: 'medium',
            
            // Notifications
            pushNotifications: true,
            transactionAlerts: true,
            priceAlerts: false,
            alertThreshold: 10,
            
            // API
            apiEndpoint: 'http://localhost:8000',
            requestTimeout: 30,
            rateLimiting: true,
            
            // Privacy
            analytics: false,
            dataRetention: 30,
            autoLogout: false
        };
        
        // Initialize
        window.addEventListener('load', () => {
            if (window.ethereyeApi) {
                apiClient = window.ethereyeApi;
                console.log('‚úÖ API Client connected');
            }
            
            loadSettings();
            updateStats();
            checkApiStatus();
        });
        
        function loadSettings() {
            // Load from localStorage or use defaults
            const savedSettings = localStorage.getItem('ethereyeSettings');
            settings = savedSettings ? { ...defaultSettings, ...JSON.parse(savedSettings) } : { ...defaultSettings };
            
            // Update UI elements
            Object.entries(settings).forEach(([key, value]) => {
                const element = document.getElementById(key);
                if (!element) return;
                
                if (element.classList.contains('toggle-switch')) {
                    element.classList.toggle('active', value);
                } else if (element.tagName === 'INPUT') {
                    element.value = value;
                } else if (element.tagName === 'SELECT') {
                    element.value = value;
                }
            });
            
            // Update profile info
            document.getElementById('profileName').textContent = settings.displayName;
            document.getElementById('profileEmail').textContent = settings.emailAddress;
            
            console.log('‚öôÔ∏è Settings loaded:', settings);
        }
        
        function toggleSetting(settingKey) {
            const element = document.getElementById(settingKey);
            const newValue = !element.classList.contains('active');
            
            element.classList.toggle('active', newValue);
            settings[settingKey] = newValue;
            
            // Apply immediate effects
            if (settingKey === 'darkMode') {
                document.body.style.filter = newValue ? 'none' : 'brightness(1.2) contrast(0.9)';
            } else if (settingKey === 'compactMode') {
                document.body.style.fontSize = newValue ? '0.9em' : '1em';
            }
            
            showNotification(`${settingKey} ${newValue ? 'enabled' : 'disabled'}`, 'info');
        }
        
        function saveSettings() {
            const saveBtn = document.getElementById('saveBtn');
            saveBtn.disabled = true;
            saveBtn.textContent = 'üíæ Saving...';
            
            // Collect current values
            const formElements = {
                displayName: document.getElementById('displayName'),
                emailAddress: document.getElementById('emailAddress'),
                currency: document.getElementById('currency'),
                language: document.getElementById('language'),
                themeColor: document.getElementById('themeColor'),
                fontSize: document.getElementById('fontSize'),
                alertThreshold: document.getElementById('alertThreshold'),
                apiEndpoint: document.getElementById('apiEndpoint'),
                requestTimeout: document.getElementById('requestTimeout'),
                dataRetention: document.getElementById('dataRetention')
            };
            
            Object.entries(formElements).forEach(([key, element]) => {
                if (element && element.value) {
                    settings[key] = element.type === 'number' ? parseFloat(element.value) : element.value;
                }
            });
            
            // Save to localStorage
            localStorage.setItem('ethereyeSettings', JSON.stringify(settings));
            
            // Update profile display
            document.getElementById('profileName').textContent = settings.displayName;
            document.getElementById('profileEmail').textContent = settings.emailAddress;
            
            setTimeout(() => {
                saveBtn.disabled = false;
                saveBtn.textContent = 'üíæ Save Changes';
                showNotification('‚úÖ Settings saved successfully!', 'success');
            }, 1000);
        }
        
        function resetSettings() {
            if (confirm('Are you sure you want to reset all settings to defaults?')) {
                settings = { ...defaultSettings };
                localStorage.setItem('ethereyeSettings', JSON.stringify(settings));
                location.reload();
            }
        }
        
        function updateStats() {
            // Get data from localStorage
            const wallets = JSON.parse(localStorage.getItem('ethereyeWallets')) || [];
            const searches = JSON.parse(localStorage.getItem('ethereyeRecentSearches')) || [];
            const firstVisit = localStorage.getItem('ethereyeFirstVisit');
            
            if (!firstVisit) {
                localStorage.setItem('ethereyeFirstVisit', new Date().toISOString());
            }
            
            const daysActive = firstVisit ? 
                Math.floor((Date.now() - new Date(firstVisit).getTime()) / (1000 * 60 * 60 * 24)) + 1 : 1;
            
            document.getElementById('walletsCount').textContent = wallets.length;
            document.getElementById('searchesCount').textContent = searches.length;
            document.getElementById('daysActive').textContent = daysActive;
        }
        
        async function checkApiStatus() {
            const statusIndicator = document.getElementById('apiStatus');
            const statusText = document.getElementById('apiStatusText');
            const lastChecked = document.getElementById('lastChecked');
            
            try {
                if (apiClient) {
                    const health = await apiClient.healthCheck();
                    statusIndicator.classList.remove('offline');
                    statusText.textContent = 'Connected';
                    statusText.style.color = '#28a745';
                } else {
                    throw new Error('API client not available');
                }
            } catch (error) {
                statusIndicator.classList.add('offline');
                statusText.textContent = 'Offline';
                statusText.style.color = '#dc3545';
            }
            
            lastChecked.textContent = new Date().toLocaleTimeString();
        }
        
        async function testApiConnection() {
            const endpoint = document.getElementById('apiEndpoint').value || settings.apiEndpoint;
            
            showNotification('üîå Testing API connection...', 'info');
            
            try {
                const response = await fetch(`${endpoint}/health`);
                if (response.ok) {
                    showNotification('‚úÖ API connection successful!', 'success');
                    await checkApiStatus();
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                showNotification('‚ùå API connection failed: ' + error.message, 'error');
            }
        }
        
        function changeAvatar() {
            const avatars = ['üë§', 'üßë‚Äçüíª', 'üë®‚Äçüíª', 'üë©‚Äçüíª', 'ü¶∏', 'ü¶∏‚Äç‚ôÄÔ∏è', 'ü§ñ', 'üëΩ', 'üê±', 'üê∂'];
            const currentAvatar = document.querySelector('.avatar').textContent;
            let newAvatar;
            
            do {
                newAvatar = avatars[Math.floor(Math.random() * avatars.length)];
            } while (newAvatar === currentAvatar);
            
            document.querySelector('.avatar').textContent = newAvatar;
            settings.avatar = newAvatar;
            showNotification('üë§ Avatar updated!', 'success');
        }
        
        function clearSearchHistory() {
            if (confirm('Are you sure you want to clear your search history?')) {
                localStorage.removeItem('ethereyeRecentSearches');
                showNotification('üóëÔ∏è Search history cleared', 'info');
                updateStats();
            }
        }
        
        function clearWalletData() {
            if (confirm('Are you sure you want to clear all wallet data? This cannot be undone.')) {
                localStorage.removeItem('ethereyeWallets');
                showNotification('üóëÔ∏è Wallet data cleared', 'warning');
                updateStats();
            }
        }
        
        function resetAllSettings() {
            if (confirm('Are you sure you want to reset ALL settings? This will also clear your data.')) {
                // Clear all ETHEREYE data
                Object.keys(localStorage).forEach(key => {
                    if (key.startsWith('ethereye')) {
                        localStorage.removeItem(key);
                    }
                });
                
                showNotification('üî• All settings reset!', 'warning');
                setTimeout(() => location.reload(), 2000);
            }
        }
        
        function deleteAllData() {
            const confirmation = prompt('This will DELETE ALL DATA permanently. Type "DELETE" to confirm:');
            if (confirmation === 'DELETE') {
                localStorage.clear();
                showNotification('üíÄ All data deleted!', 'error');
                setTimeout(() => location.reload(), 3000);
            }
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }
        
        // Auto-save on input changes
        document.addEventListener('input', (e) => {
            if (e.target.classList.contains('input-field') || e.target.classList.contains('select-field')) {
                // Debounced auto-save
                clearTimeout(window.autoSaveTimeout);
                window.autoSaveTimeout = setTimeout(() => {
                    const key = e.target.id;
                    const value = e.target.type === 'number' ? parseFloat(e.target.value) : e.target.value;
                    settings[key] = value;
                }, 1000);
            }
        });
        
        // Periodic API status check
        setInterval(checkApiStatus, 60000); // Check every minute
    </script>
</body>
</html>